<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, sans-serif;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #1d2671, #c33764);
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 450px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            animation: fadeIn 1s ease;
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 36px;
            margin-bottom: 10px;
            color: #ffd166;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        h2 {
            font-size: 24px;
            margin-bottom: 30px;
            text-align: center;
            color: #fff;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
        }

        .form-control {
            width: 100%;
            padding: 15px 20px;
            border: none;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            background: white;
            box-shadow: 0 0 0 3px rgba(255, 209, 102, 0.5);
        }

        .form-control::placeholder {
            color: #999;
        }

        .btn {
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: 15px;
            background: linear-gradient(to right, #ffd166, #ffb347);
            color: #1d2671;
            font-size: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            background: linear-gradient(to right, #ffda7f, #ffc166);
        }

        .links {
            text-align: center;
            margin-top: 25px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .links a {
            color: #ffd166;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            padding: 8px;
            border-radius: 10px;
        }

        .links a:hover {
            text-decoration: underline;
            color: #ffda7f;
            background: rgba(255, 255, 255, 0.1);
        }

        .messages {
            margin-bottom: 25px;
        }

        .alert {
            padding: 15px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.9);
            color: #c33764;
            font-weight: 500;
            text-align: center;
            animation: slideIn 0.5s ease;
            border-left: 4px solid #c33764;
        }

        .alert-success {
            background: rgba(40, 167, 69, 0.9);
            color: white;
            border-left-color: #28a745;
        }

        .alert-info {
            background: rgba(23, 162, 184, 0.9);
            color: white;
            border-left-color: #17a2b8;
        }

        .alert-warning {
            background: rgba(255, 193, 7, 0.9);
            color: #333;
            border-left-color: #ffc107;
        }

        .error-message {
            margin-top: 5px;
            color: #ff6b6b;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 8px;
            border-left: 4px solid #ff6b6b;
        }

        .remember-me {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: rgba(255, 255, 255, 0.9);
        }

        .remember-me input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #ffd166;
            cursor: pointer;
        }

        .password-toggle {
            position: relative;
        }

        .password-toggle .toggle-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: #666;
            font-size: 18px;
        }

        .password-toggle .toggle-icon:hover {
            color: #333;
        }

        .back-link {
            display: inline-block;
            margin-top: 20px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .back-link:hover {
            color: #ffd166;
            transform: translateX(-3px);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }

        @media (max-width: 768px) {
            .container {
                padding: 30px 20px;
            }

            h1 {
                font-size: 28px;
            }

            h2 {
                font-size: 20px;
            }

            .form-control {
                padding: 12px 15px;
            }

            .btn {
                padding: 16px;
                font-size: 18px;
            }
        }

        .features {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .feature {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .feature-icon {
            color: #ffd166;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">
            <h1>–®–∫–æ–ª–∞ ‚Ññ4</h1>
            <p>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫</p>
        </div>

        <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>

        {% if messages %}
        <div class="messages">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% if form.errors %}
        <div class="alert alert-warning">
            ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.
        </div>
        {% endif %}

        {% if next %}
            {% if user.is_authenticated %}
            <div class="alert alert-info">
                ‚ö†Ô∏è –£ –≤–∞—à–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
                –ß—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å, –≤–æ–π–¥–∏—Ç–µ —Å —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é, —É –∫–æ—Ç–æ—Ä–æ–π –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø.
            </div>
            {% else %}
            <div class="alert alert-info">
                üîí –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É.
            </div>
            {% endif %}
        {% endif %}

        <form method="POST" action="{% url 'login' %}">
            {% csrf_token %}

            <input type="hidden" name="next" value="{{ next }}">

            <div class="form-group">
                <label for="id_username" class="form-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ Email</label>
                <input type="text" name="username" class="form-control" required id="id_username"
                       placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏–ª–∏ email" autocomplete="username"
                       value="{{ form.username.value|default:'' }}">
                {% if form.username.errors %}
                <div class="error-message">
                    {{ form.username.errors }}
                </div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="id_password" class="form-label">–ü–∞—Ä–æ–ª—å</label>
                <div class="password-toggle">
                    <input type="password" name="password" class="form-control" required id="id_password"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" autocomplete="current-password">
                    <span class="toggle-icon" onclick="togglePassword()">üëÅÔ∏è</span>
                </div>
                {% if form.password.errors %}
                <div class="error-message">
                    {{ form.password.errors }}
                </div>
                {% endif %}
            </div>

            <div class="remember-me">
                <input type="checkbox" name="remember" id="id_remember">
                <label for="id_remember">–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è</label>
            </div>

            <button type="submit" class="btn" id="login-btn">
                üîë –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É
            </button>
        </form>

        <div class="links">
            <a href="{% url 'register' %}">üìù –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
            <a href="#" onclick="showPasswordReset()">üîì –ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</a>
            <a href="/admin/" target="_blank">‚öôÔ∏è –í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</a>
        </div>

        <div class="features">
            <div class="feature">
                <span class="feature-icon">üìö</span>
                <span>–ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ü–µ–Ω–æ–∫ –∏ –∑–∞–¥–∞–Ω–∏–π</span>
            </div>
        </div>

        <a href="/" class="back-link">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è -->
    <div id="password-reset-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
        <div style="background: white; padding: 30px; border-radius: 15px; max-width: 400px; width: 90%;">
            <h3 style="color: #333; margin-bottom: 20px;">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è</h3>
            <p style="color: #666; margin-bottom: 20px;">–î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —Å–∏—Å—Ç–µ–º—ã.</p>
            <button onclick="hidePasswordReset()" style="padding: 10px 20px; background: #c33764; color: white; border: none; border-radius: 10px; cursor: pointer;">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script>
        function togglePassword() {
            const passwordInput = document.getElementById('id_password');
            const toggleIcon = document.querySelector('.toggle-icon');

            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.textContent = 'üëÅÔ∏è‚Äçüó®Ô∏è';
            } else {
                passwordInput.type = 'password';
                toggleIcon.textContent = 'üëÅÔ∏è';
            }
        }

        function showPasswordReset() {
            document.getElementById('password-reset-modal').style.display = 'flex';
        }

        function hidePasswordReset() {
            document.getElementById('password-reset-modal').style.display = 'none';
        }

        document.addEventListener('DOMContentLoaded', function() {
            // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –ª–æ–≥–∏–Ω–∞
            const usernameInput = document.getElementById('id_username');
            if (usernameInput) {
                usernameInput.focus();
            }

            // –ê–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –æ—à–∏–±–∫–µ
            const form = document.querySelector('form');
            const loginBtn = document.getElementById('login-btn');

            form.addEventListener('submit', function(e) {
                // –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏, –¥–æ–±–∞–≤–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é
                if (document.querySelector('.alert-warning')) {
                    loginBtn.classList.add('shake');
                    setTimeout(() => {
                        loginBtn.classList.remove('shake');
                    }, 500);
                }
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ–≥–æ
            const modal = document.getElementById('password-reset-modal');
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    hidePasswordReset();
                }
            });

            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–∏–Ω–∞ –≤ localStorage
            const rememberCheckbox = document.getElementById('id_remember');
            const savedUsername = localStorage.getItem('remembered_username');

            if (savedUsername && usernameInput) {
                usernameInput.value = savedUsername;
                rememberCheckbox.checked = true;
            }

            // –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–≥–∏–Ω –µ—Å–ª–∏ —á–µ–∫–±–æ–∫—Å –æ—Ç–º–µ—á–µ–Ω
            form.addEventListener('submit', function() {
                if (rememberCheckbox.checked && usernameInput.value) {
                    localStorage.setItem('remembered_username', usernameInput.value);
                } else {
                    localStorage.removeItem('remembered_username');
                }
            });

            // –ü–æ–∫–∞–∑/—Å–∫—Ä—ã—Ç–∏–µ –ø–∞—Ä–æ–ª—è –ø–æ Ctrl+H
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'h') {
                    e.preventDefault();
                    togglePassword();
                }
            });
        });

        // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function fillDemoCredentials(role) {
            const usernameInput = document.getElementById('id_username');
            const passwordInput = document.getElementById('id_password');

            if (role === 'student') {
                usernameInput.value = 'ivanov_student';
                passwordInput.value = 'student123';
            } else if (role === 'teacher') {
                usernameInput.value = 'petrov_teacher';
                passwordInput.value = 'teacher123';
            }

            // –§–æ–∫—É—Å –Ω–∞ –ø–∞—Ä–æ–ª–µ –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
            passwordInput.focus();
        }
    </script>
</body>
</html>
